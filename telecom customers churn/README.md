# Проект "Отток клиентов"


## Данные

Данные состоят из файлов, полученных из разных источников:
- contract.csv — информация о договоре;
- personal.csv — персональные данные клиента;
- internet.csv — информация об интернет-услугах;
- phone.csv — информация об услугах телефонии.
Во всех файлах столбец customerID содержит код клиента.
Информация о договорах актуальна на 1 февраля 2020.

## Задача

Нужно спрогнозировать отток клиентов оператора связи «Ниединогоразрыва.ком». 
Поттенциально отточным клиентам будут предложены промокоды и спец условия для их удержания.

## Ход исследования

* Загрузили и проанализировали данные, каждый из 4 файлов отдельно.
* Подготовили  данные для работы с машинным обучением - объединили данные по customerID и обработали образовавшиеся пропуски. 
* Разделили на обучающую и тестовую выборки. Применение GridSearchCV позволило определить не только значения гиперпараметров лучшей модели, но и значение целевой метрики roc-auc на кросс-валидации. Потребность в валидационной выборке пропала.
* Нормальзовали количественные данные и закодировали категориальные техникой ОНЕ для использования в линейной регрессии.
Закодировали категориальные техникой Ordinal для использования в Randomforest. 
* Применили 3 модели: логистическую регрессию, RandomForest и CatBoost
* Подобрали гиперпараметры, проверили работу лучшей модели на тестовой выборке
* Проанализировали результаты, оценили применимость модели для бизнес-решений

## Выводы
- Лучший результат показала модель CatBoostClassifier с гиперпараметрами depth = 7, iterations = 200, learning_rate = 0.04
- Значение метрики auc-roc на обучающей и тестовой выборках равно 0,91 и 0,92 соответственно.
- Модель верно распознала 87% клиентов. 10% клиентов она приняла за уходящих, хотя на самом деле они не собирались расставаться с оператором. 3% клиентов ушли не замеченными моделью.
- Наиболее значимые признаки - срок жизни клиента, год заключения контракта, тип контракта (оплата за год/ два или помесячно), сумма ежемесячных комиссий и наличие у клиента сервиса блокировки небезопасных сайтов.
- При использовании модели для удержания потенциально отточных клиентов следует заложить 10% погрешность в бюджете на скидки и без того лояльным клиентам.
- 3% уходящих клиентов не будут распознаны моделью. Взаимодействие с наиболее ценными и доходными следует вести через личные контакты, персональных менеджеров, интересующихся удовлетворенностью и планами клиентов.

## Используемые библиотеки
*pandas, sklearn, catboost, matplotlib*
