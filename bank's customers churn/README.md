# Проект "Отток клиентов из банка"


## Данные

Предоставлены исторические данные о поведении клиентов и расторжении договоров с банком.

Источник данных: https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling


## Задача

Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. 
Нужно построить модель с предельно большим значением F1-меры, не менее 0.59


## Ход исследования
- Подготовили данные - 10 тыс ненулевых значений:
  - распределение не вызвало вопросов
  - проверили дублирование 
  - удалили столбцы, не участвующие в аналите
  - заменили пропуски, чтобы сработало кодирование
  - кодировали пол и географию через get_dummies
- Разбили выборку на тестовую, валидационную и обучающую в соотношении 5:15:80
- Протестировали на логистической регрессии, деревьях решений и случайном лесе. Целевого значения F1-меры - 0.59 - не достила ни одна модель.
- Добавили в модели аргументы взвешивания классов. Взвешивание классов не дало нужного эффекта на F1.
- Проверили работу моделей на upsampled и на downsampled выборках. Модели не дали целевой результат ни на увеличенной, ни на уменьшенной выборке.
- Подобрали гиперпараметры модели RandomForestClassifier - достигли целевого F1 на upsampled выборке.
- Проверили работу модели RandomForestClassifier c 60 деревьями глубиной до 11 на всех трех выборках: 
  - f1_test: 0.65
  - f1_valid: 0.64
  - f1_train: 0.82
  Целевое значение F1-меры достигнуто.

## Выводы

- Модель верно распознает 86% клиентов. Но не отловила 35% оттекающих клиентов - плохо.
- Расходы на удержание клиентов, которые на самом деле не собирались оттекать, составят 55% от расходов на true positive clients - тоже негативный фактор.
- 14% бюджета, направленного на удержание, может быть потрачено впустую - нужно учитывать при планировании коммуникационной компании.
- Для удержания клиента обычно нужно продать новый продукт. Доходы от проданных продуктов должы покрыть расходы на коммуникацию и удержание - важно учесть при планировании продаж.


## Используемые библиотеки
*pandas, matplotlib, sklearn*
